<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Title</title>
    <link href="css/normalize.css" rel="stylesheet">
    <link href="css/default.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <!--[if IE]>
    <script src="http://libs.useso.com/js/html5shiv/3.7/html5shiv.min.js"></script>
    <![endif]-->
</head>
<body>
    <div class="container">
        <div class="chatbox">
            <div class="friendslist">
                <div class="topmenu">
                    <span class="friends active"></span>
                    <span class="chats"></span>
                    <span class="history"></span>
                </div>
                <div class="friends">
                    <div class="friend">
                        <img src="img/1_copy.jpg" alt="user"/>
                        <p>
                            <strong>Miro Badev</strong>
                            <span>mirobadev@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/2_copy.jpg" alt="user"/>
                        <p>
                            <strong>Martin Joseph</strong>
                            <span>marjoseph@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/3_copy.jpg" alt="user"/>
                        <p>
                            <strong>Tomas Kennedy</strong>
                            <span>tomaskennedy@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/4_copy.jpg" alt="user"/>
                        <p>
                            <strong>Enrique	Sutton</strong>
                            <span>enriquesutton@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/5_copy.jpg" alt="user"/>
                        <p>
                            <strong>Darnell	Strickland</strong>
                            <span>darnellstrickland@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/2_copy.jpg" alt="user"/>
                        <p>
                            <strong>Martin Joseph</strong>
                            <span>marjoseph@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/3_copy.jpg" alt="user"/>
                        <p>
                            <strong>Tomas Kennedy</strong>
                            <span>tomaskennedy@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/4_copy.jpg" alt="user"/>
                        <p>
                            <strong>Enrique	Sutton</strong>
                            <span>enriquesutton@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                    <div class="friend">
                        <img src="img/5_copy.jpg" alt="user"/>
                        <p>
                            <strong>Darnell	Strickland</strong>
                            <span>darnellstrickland@gmail.com</span>
                        </p>
                        <div class="status available"></div>
                    </div>
                </div>
                <div class="search">
                    <i></i>
                    <input type="text" placeholder="Search Contacts...">
                </div>
            </div>
            <div id="chatview">
                <div id="profile">
                    <div class="avatar"></div>
                    <div id="close">
                        <img src="img/close.png" alt="close">
                    </div>
                    <p></p>
                    <span></span>
                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script>
        $(function () {
            $('.chatbox').on('click','.friend',function () {/*打开chatview*/
                /* this - img 头像 */
                var $img = $(this).children('img');
                /* img 偏移量 */
                var position = $img.offset();
                /* img src */
                var userIcon = $img.attr('src');
                /* this - p */
                var $p = $(this).children('p');
                /* this - p - strong*/
                var $strong = $($p).children('strong');
                /* this - p - span */
                var $span = $($p).children('span');
                /* this - p - strong 用户名 */
                var userName = $strong[0].innerHTML;
                /* this - p - span 用户com */
                var userUrl = $span[0].innerHTML;
                /* chatview - avatar 用户头像 */
                var $avatar = $('#chatview > #profile > .avatar');
                /* container 追加 user-avatar元素 */
                $('.container').append('<div class="user-avatar"></div>');
                var $user_avatar = $('div.user-avatar');
                /* 用户头像clone 一个元素添加到 user-avatar 上 */
                $img.clone().appendTo($user_avatar);
                /* chatview淡入 */
                $('#chatview').fadeIn(200);
                /* 用户头像移动到chatview-avatar 位置 */
                $user_avatar.css({
                    'left':0 + 'px',
                    'top':position.top + 'px',
                }).fadeOut(300).addClass('avatarMove');
                /* chatview - avatar */
                $avatar.css({
                    'backgroundImage':'url('+ userIcon +')',
                });
                /* chatview - p 用户名 */
                $('#chatview > #profile > p')[0].innerHTML = userName;
                /* chatview - span 用户名com */
                $('#chatview > #profile > span')[0].innerHTML = userUrl;
                /* 切换时的动画 */
                $('#chatview > #profile > p').addClass('active');
                $('#chatview > #profile > span').addClass('active');
            }).on('click','#close',function () {/*关闭chatview*/
                /* chatview淡出 */
                $('#chatview').fadeOut(300);
                $('#chatview > #profile > p').removeClass('active');
                $('#chatview > #profile > span').removeClass('active');
                $('div.user-avatar').remove();
            }).on('click','.friends',function () {
                $(this).addClass('active');
                $(this).siblings().removeClass('active');
            }).on('click','.chats',function () {
                $(this).addClass('active');
                $(this).siblings().removeClass('active');
            }).on('click','.history',function () {
                $(this).addClass('active');
                $(this).siblings().removeClass('active');
            });
        })
    </script>
</body>
</html>